<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electron integrity checker</title>

    <!-- SEO -->
    <link rel="icon" type="image/png" sizes="32x32" href="img/pandora_logo.png">
    <link rel="apple-touch-icon" href="img/pandora_logo.png">
    <meta name="description" content="Pandora es tu portal para herramientas digitales, descargas y recursos de alta calidad. Explora contenido optimizado y seguro para desarrolladores y usuarios tech.">
    <meta name="keywords" content="Electron, integrity, checker, discord, teams, vscode, Visual Studio Code">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.getpandorabox.com">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="PandoraBox | The Forensics & Reversing OS">
    <meta name="twitter:description" content="Discover Pandora, the ultimate operating system for forensics and reverse engineering">
    <meta name="twitter:image" content="https://www.getpandorabox.com/img/pandora_logo.png">
    <meta name="twitter:site" content="@minimik77">

    <meta property="og:title" content="PandoraBox | The Forensics & Reversing OS">
    <meta property="og:description" content="Discover Pandora, the ultimate operating system for forensics and reverse engineering">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.getpandorabox.com">
    <meta property="og:image" content="https://www.getpandorabox.com/img/pandora_logo.png">

    <!-- Bootstrap 5 CSS -->
    <link href="libs/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700,0..1&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VVBKKLJ2C2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-VVBKKLJ2C2');
    </script>

    <style>
        :root {
            --bs-primary: #f47b25;
            --bs-primary-rgb: 244, 123, 37;
            --bg-dark: #221710;
            --bg-light: #f8f7f5;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: var(--bg-dark);
            color: #f8f9fa;
        }

        .bg-mesh {
            background-image: 
                radial-gradient(at 0% 0%, rgba(244, 123, 37, 0.05) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(244, 123, 37, 0.05) 0px, transparent 50%);
            min-height: 100vh;
        }

        /* Custom utility classes mimicking tailwind styles */
        .text-primary-custom { color: var(--bs-primary) !important; }
        .bg-primary-custom { background-color: var(--bs-primary) !important; }
        
        /* Navbar */
        .navbar-custom {
            background-color: rgba(34, 23, 16, 0.8) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(244, 123, 37, 0.2);
        }
        
        .nav-link-custom {
            color: #cbd5e1 !important;
            font-size: 0.875rem;
            font-weight: 500;
            transition: color 0.2s;
        }
        .nav-link-custom:hover, .nav-link-custom.active {
            color: var(--bs-primary) !important;
        }
        .nav-link-custom.active {
            border-bottom: 2px solid var(--bs-primary);
        }

        /* Search input */
        .search-wrapper {
            background-color: rgba(244, 123, 37, 0.1);
            border-radius: 0.5rem;
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        .search-icon {
            color: #94a3b8;
            padding-left: 1rem;
        }
        .search-input {
            background: transparent;
            border: none;
            color: #f8f9fa;
            box-shadow: none;
        }
        .search-input:focus {
            background: transparent;
            color: #f8f9fa;
            box-shadow: none;
        }
        .search-input::placeholder {
            color: #64748b;
        }

        /* Button upgrade */
        .btn-upgrade {
            background-color: var(--bs-primary);
            color: var(--bg-dark);
            font-weight: 700;
            font-size: 0.875rem;
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            transition: transform 0.1s;
        }
        .btn-upgrade:active {
            transform: scale(0.95);
        }

        /* Profile avatar */
        .avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            border: 2px solid rgba(244, 123, 37, 0.3);
            background-size: cover;
            background-position: center;
        }

        /* Hero text */
        .display-hero {
            font-weight: 900;
            letter-spacing: -0.025em;
            color: #f8f9fa;
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .lead-text {
            color: #94a3b8;
            font-size: 1.125rem;
            max-width: 42rem;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed rgba(244, 123, 37, 0.3);
            background-color: rgba(244, 123, 37, 0.05);
            border-radius: 0.75rem;
            padding: 5rem 2rem;
            text-align: center;
            transition: all 0.2s;
            cursor: pointer;
        }
        .upload-area:hover {
            border-color: rgba(244, 123, 37, 0.6);
        }
        .upload-icon-wrapper {
            width: 4rem;
            height: 4rem;
            background-color: rgba(244, 123, 37, 0.2);
            color: var(--bs-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
        }

        /* Status Cards */
        .status-card {
            border-radius: 0.75rem;
            padding: 2rem;
        }
        .status-card-safe {
            background-color: rgba(244, 123, 37, 0.05);
            border: 1px solid rgba(244, 123, 37, 0.1);
        }
        .status-card-threat {
            background-color: rgba(239, 68, 68, 0.05);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        .badge-safe-header {
            background-color: rgba(244, 123, 37, 0.1);
            color: var(--bs-primary);
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            padding: 0.25rem 0.5rem;
        }
        .badge-threat-header {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            padding: 0.25rem 0.5rem;
        }

        /* LED Indicators */
        .led-container {
            background-color: rgba(15, 23, 42, 0.5);
            border: 1px solid #334155;
            border-radius: 9999px;
            padding: 0.75rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .led {
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .led-inner { width: 0.75rem; height: 0.75rem; border-radius: 50%; }
        
        /* Safe LEDs */
        .led-red-dim { background-color: rgba(127, 29, 29, 0.2); border: 1px solid rgba(127, 29, 29, 0.5); }
        .led-red-dim .led-inner { background-color: rgba(127, 29, 29, 0.3); }
        .led-yellow-dim { background-color: rgba(113, 63, 18, 0.2); border: 1px solid rgba(113, 63, 18, 0.5); }
        .led-yellow-dim .led-inner { background-color: rgba(113, 63, 18, 0.3); }
        .led-green-bright { background-color: #22c55e; box-shadow: 0 0 15px rgba(34, 197, 94, 0.6); }
        .led-green-bright .led-inner { background-color: #bbf7d0; }

        /* Threat LEDs */
        .led-red-bright { background-color: #ef4444; box-shadow: 0 0 15px rgba(239, 68, 68, 0.6); }
        .led-red-bright .led-inner { background-color: #fee2e2; }
        .led-green-dim { background-color: rgba(20, 83, 45, 0.2); border: 1px solid rgba(20, 83, 45, 0.5); }
        .led-green-dim .led-inner { background-color: rgba(20, 83, 45, 0.3); }

        /* Activity List */
        .activity-list {
            background-color: rgba(244, 123, 37, 0.05);
            border: 1px solid rgba(244, 123, 37, 0.1);
            border-radius: 0.75rem;
            overflow: hidden;
        }
        .activity-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(244, 123, 37, 0.1);
            transition: background-color 0.2s;
        }
        .activity-item:last-child { border-bottom: none; }
        .activity-item:hover { background-color: rgba(244, 123, 37, 0.1); }
        
        .activity-icon {
            width: 2.5rem;
            height: 2.5rem;
            background-color: var(--bg-dark);
            color: var(--bs-primary);
            border-radius: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Footer */
        .footer-custom {
            border-top: 1px solid rgba(244, 123, 37, 0.1);
            background-color: rgba(34, 23, 16, 0.5);
            padding: 2rem 2.5rem;
        }
        .footer-link {
            color: #64748b;
            font-size: 0.75rem;
            text-decoration: none;
            transition: color 0.2s;
        }
        .footer-link:hover { color: var(--bs-primary); }
    </style>
</head>
<body>
    <div class="bg-mesh d-flex flex-column">
        
        <!-- Header -->
        <header class="navbar-custom sticky-top px-4 py-3">
            <div class="container-fluid d-flex justify-content-between align-items-center">
                <!-- Logo & Nav -->
                <div class="d-flex align-items-center gap-4">
                    <div class="d-flex align-items-center gap-2 text-primary-custom">
                        <img width="40px" height="40px" src="img/pandora_logo.png" alt="Default PandoraBox logo">
                        <h2 class="h5 mb-0 fw-bold text-light">Electron Integrity Checker ~ by PandoraBox framework</h2>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow-1 py-5">
            <div class="container" style="max-width: 1000px;">
                
                <!-- Hero Section -->
                <div class="mb-5">
                    <h1 class="display-hero">Scan your apps</h1>
                    <p class="lead-text">Upload your .exe, .elf files to check if applications written in Electron does integrity check for the ASAR file (this check will run locally on your browser, no files are uploaded to any server)</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area mb-5">
                    <div class="upload-icon-wrapper">
                        <span class="material-symbols-outlined fs-1">cloud_upload</span>
                    </div>
                    <p class="text-secondary small mb-4">Supported formats: .exe, .elf...</p>
                    <button id="button_file_uploader" class="btn" style="background-color: rgba(244, 123, 37, 0.2); color: var(--bs-primary); border: 1px solid rgba(244, 123, 37, 0.4); font-weight: bold; padding: 0.75rem 2rem;">
                        Select File
                    </button>
                    <input id="file_uploader" type="file" hidden>
                </div>

                <!-- Status Cards Grid -->
                <div class="row g-4 mb-5">
                    <!-- Safe Status Card -->
                    <div id="sucess_status" hidden>
                        <div class="status-card status-card-safe h-100">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h3 class="h6 fw-bold text-light mb-0">Security Status</h3>
                            </div>
                            
                            <div class="d-flex align-items-center gap-4">
                                <div class="d-flex flex-column align-items-center gap-3">
                                    <div class="led-container">
                                        <div class="led led-red-dim"><div class="led-inner"></div></div>
                                        <div class="led led-yellow-dim"><div class="led-inner"></div></div>
                                        <div class="led led-green-bright"><div class="led-inner"></div></div>
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="fs-3 fw-bold text-light mb-1">App Secure</div>
                                    <p class="text-success small fw-bold mb-2 d-flex align-items-center gap-1">
                                        <span class="material-symbols-outlined" style="font-size: 1rem;">verified_user</span>
                                        ASAR Integrity verified!
                                    </p>
                                    <p id="asar_content_tag" class="small fw-bold mb-2 d-flex align-items-center gap-1">
                                        <span class="material-symbols-outlined" style="font-size: 1rem;">tag</span>
                                        
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Threat Status Card -->
                    <div id="thread_status" hidden>
                        <div class="status-card status-card-threat h-100">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h3 class="h6 fw-bold text-light mb-0">Potential Threats</h3>
                                <span class="badge badge-threat-header rounded-1 text-uppercase fw-bold">Vulnerability Detected</span>
                            </div>
                            
                            <div class="d-flex align-items-center gap-4">
                                <div class="d-flex flex-column align-items-center gap-3">
                                    <div class="led-container">
                                        <div class="led led-red-bright"><div class="led-inner"></div></div>
                                        <div class="led led-yellow-dim"><div class="led-inner"></div></div>
                                        <div class="led led-green-dim"><div class="led-inner"></div></div>
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="fs-3 fw-bold text-light mb-1">Threat Found</div>
                                    <p class="text-danger small fw-bold mb-2 d-flex align-items-center gap-1">
                                        <span class="material-symbols-outlined" style="font-size: 1rem;">warning</span>
                                        App does not check for ASAR integrity, it can be tampered!
                                    </p>
                                    <p class="small text-secondary fst-italic mb-0" style="font-size: 0.75rem;">Recommendation: Check the ASAR size and compare hashes with the official ones</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer bg-black bg-opacity-50">
            <div class="container text-center">
                <div class="d-flex justify-content-center align-items-center gap-2 mb-4">                
                    <img width="30px" height="30px" src="img/pandora_logo.png">
                    <span class="fw-bold text-white">PANDORABOX<span class="text-primary-custom">OS</span></span>
                </div>
                <div class="d-flex justify-content-center gap-4 mb-4 text-uppercase fw-bold" style="font-size: 0.75rem;">
                    <!-- <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a> -->
                    <a href="https://www.linkedin.com/in/miguel-moreno-pastor/">Contact</a>
                    <a href="https://github.com/mimorep">GitHub</a>
                </div>
                <p class="mb-0 text-muted opacity-50 small">&copy; 2026 PandoraBox by Miguel Moreno Pastor ~M7.</p>
            </div>
        </footer>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="libs/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script>
            /**
             * @description Buffers the provided file and then run strings on the buffer to check integrity
            */
            async function scan_binnary (file)
            {
                try
                {
                    const PATTERNS = [   
                        `"alg":"SHA256"`
                    ];

                    let buffer = await file.arrayBuffer(),
                        bytes = new Uint8Array(buffer),
                        text = new TextDecoder("latin1").decode(bytes),
                        substring = undefined;

                    for (let p of PATTERNS)
                    {
                        if (text.includes(p))
                        {
                            // Get the index of the string
                            let index = text.indexOf(p);
                                
                            substring = text.substring(index - 31, index + 91); // Total: 122 chars

                            break;   
                        }
                    }             
                    
                    return (substring.length > 0)? substring : false;

                }
                catch (error)
                {
                    console.error(`[-] Error decoding: ${error}`);
                }
            }
            
            document.getElementById("button_file_uploader").addEventListener('click', e => {
                
                // hide all data again
                document.getElementById("thread_status").setAttribute("hidden", "");                
                document.getElementById("sucess_status").setAttribute("hidden", "");  
                
                document.getElementById("asar_content_tag").innerText = "";                


                e.preventDefault();
                document.getElementById("file_uploader").click();
            });

            document.getElementById("file_uploader").addEventListener('change', async (e) => {
            let file = e.target.files[0],
                result = await scan_binnary(file);

                if (result === false)
                {
                    document.getElementById("thread_status").removeAttribute("hidden");                 
                }
                else
                {
                    let hash = "Hash: " + result.substring(result.indexOf(`"value"`) + 9, result.length - 3);

                    document.getElementById("sucess_status").removeAttribute("hidden");
                    document.getElementById("asar_content_tag").append(hash)
                }
            });

    </script>
</body>
</html>